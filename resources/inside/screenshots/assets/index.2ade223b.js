var Qe=Object.defineProperty,Ze=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var Be=(e,t,r)=>t in e?Qe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,T=(e,t)=>{for(var r in t||(t={}))Ee.call(t,r)&&Be(e,r,t[r]);if(he)for(var r of he(t))je.call(t,r)&&Be(e,r,t[r]);return e},pe=(e,t)=>Ze(e,et(t));var Me=(e,t)=>{var r={};for(var o in e)Ee.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(e!=null&&he)for(var o of he(e))t.indexOf(o)<0&&je.call(e,o)&&(r[o]=e[o]);return r};import{R as _e,r as c,j as b,a as Ve,b as tt}from"./vendor.e3c417b2.js";const st=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(i){if(i.ep)return;i.ep=!0;const n=r(i);fetch(i.href,n)}};st();const $e={magnifier_position_label:"\u5750\u6807",operation_ok_title:"\u786E\u5B9A",operation_cancel_title:"\u53D6\u6D88",operation_save_title:"\u4FDD\u5B58",operation_redo_title:"\u91CD\u505A",operation_undo_title:"\u64A4\u9500",operation_mosaic_title:"\u9A6C\u8D5B\u514B",operation_text_title:"\u6587\u672C",operation_brush_title:"\u753B\u7B14",operation_arrow_title:"\u7BAD\u5934",operation_ellipse_title:"\u692D\u5706",operation_rectangle_title:"\u77E9\u5F62"};var ve=_e.createContext({store:{url:void 0,image:null,width:0,height:0,lang:$e,emiterRef:{current:{}},canvasContextRef:{current:null},history:{index:-1,stack:[]},bounds:null,cursor:"move",operation:void 0},dispatcher:{call:void 0,setHistory:void 0,setBounds:void 0,setCursor:void 0,setOperation:void 0}});function $(){const{store:e}=c.exports.useContext(ve);return e}function L(){const{lang:e}=$();return e}var q="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsMagnifier/index.tsx";const K=100,Q=80;function nt({x:e,y:t}){const{width:r,height:o,image:i}=$(),n=L(),[s,a]=c.exports.useState(null),x=c.exports.useRef(null),u=c.exports.useRef(null),p=c.exports.useRef(null),[l,h]=c.exports.useState("000000");return c.exports.useLayoutEffect(()=>{if(!x.current)return;const f=x.current.getBoundingClientRect();let m=e+20,y=t+20;m+f.width>r&&(m=e-f.width-20),y+f.height>o&&(y=t-f.height-20),m<0&&(m=0),y<0&&(y=0),a({x:m,y})},[r,o,e,t]),c.exports.useEffect(()=>{if(!i||!u.current){p.current=null;return}if(p.current||(p.current=u.current.getContext("2d")),!p.current)return;const f=p.current;f.clearRect(0,0,K,Q);const m=i.naturalWidth/r,y=i.naturalHeight/o;f.drawImage(i,e*m-K/2,t*y-Q/2,K,Q,0,0,K,Q);const{data:N}=f.getImageData(Math.floor(K/2),Math.floor(Q/2),1,1),w=Array.from(N.slice(0,3)).map(S=>S>=16?S.toString(16):`0${S.toString(16)}`).join("").toUpperCase();h(w)},[r,o,i,e,t]),b.exports.jsxDEV("div",{ref:x,className:"screenshots-magnifier",style:{transform:`translate(${s==null?void 0:s.x}px, ${s==null?void 0:s.y}px)`},children:[b.exports.jsxDEV("div",{className:"screenshots-magnifier-body",children:b.exports.jsxDEV("canvas",{ref:u,className:"screenshots-magnifier-body-canvas",width:K,height:Q},void 0,!1,{fileName:q,lineNumber:97,columnNumber:9},this)},void 0,!1,{fileName:q,lineNumber:96,columnNumber:7},this),b.exports.jsxDEV("div",{className:"screenshots-magnifier-footer",children:[b.exports.jsxDEV("div",{className:"screenshots-magnifier-footer-item",children:[n.magnifier_position_label,": (",e,",",t,")"]},void 0,!0,{fileName:q,lineNumber:105,columnNumber:9},this),b.exports.jsxDEV("div",{className:"screenshots-magnifier-footer-item",children:["RGB: #",l]},void 0,!0,{fileName:q,lineNumber:108,columnNumber:9},this)]},void 0,!0,{fileName:q,lineNumber:104,columnNumber:7},this)]},void 0,!0,{fileName:q,lineNumber:89,columnNumber:5},this)}function rt({x:e,y:t},{x:r,y:o},i,n){return e>r&&([e,r]=[r,e]),t>o&&([t,o]=[o,t]),e<0&&(e=0),r>i&&(r=i),t<0&&(t=0),o>n&&(o=n),{x:e,y:t,width:r-e,height:o-t}}function oe(){const{dispatcher:e}=c.exports.useContext(ve);return e}function U(){const{bounds:e}=$(),{setBounds:t}=oe(),r=c.exports.useCallback(i=>{t==null||t(i)},[t]),o=c.exports.useCallback(()=>{t==null||t(null)},[t]);return[e,{set:r,reset:o}]}var ye="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsBackground/index.tsx";function ot(){const{url:e,width:t,height:r}=$(),[o,i]=U(),n=c.exports.useRef(null),s=c.exports.useRef(null),[a,x]=c.exports.useState(null),u=c.exports.useCallback((l,h)=>{if(!n.current)return;const{x:f,y:m}=n.current.getBoundingClientRect();i.set(rt({x:l.x-f,y:l.y-m},{x:h.x-f,y:h.y-m},t,r))},[t,r,i]),p=c.exports.useCallback(l=>{s.current||o||l.button!==0||(s.current={x:l.clientX,y:l.clientY})},[o]);return c.exports.useEffect(()=>{const l=f=>{if(n.current){const m=n.current.getBoundingClientRect();f.clientX<m.left||f.clientY<m.top||f.clientX>m.right||f.clientY>m.bottom?x(null):x({x:f.clientX-m.x,y:f.clientY-m.y})}!s.current||u(s.current,{x:f.clientX,y:f.clientY})},h=f=>{!s.current||(u(s.current,{x:f.clientX,y:f.clientY}),s.current=null)};return window.addEventListener("mousemove",l),window.addEventListener("mouseup",h),()=>{window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",h)}},[u]),e?b.exports.jsxDEV("div",{ref:n,className:"screenshots-background",style:{backgroundImage:`url("${e}")`},onMouseDown:p,children:[b.exports.jsxDEV("div",{className:"screenshots-background-mask"},void 0,!1,{fileName:ye,lineNumber:112,columnNumber:7},this),a&&!o&&b.exports.jsxDEV(nt,{x:a==null?void 0:a.x,y:a==null?void 0:a.y},void 0,!1,{fileName:ye,lineNumber:113,columnNumber:31},this)]},void 0,!0,{fileName:ye,lineNumber:104,columnNumber:5},this):null}var Ke;const Le=(Ke=window.devicePixelRatio)!=null?Ke:2;var me=Le<2?2:Le;function it(e,t,r,o){const i=e.clientX-r.x,n=e.clientY-r.y;let s=o.x,a=o.y,x=o.x+o.width,u=o.y+o.height;switch(t){case"top":a+=n;break;case"top-right":x+=i,a+=n;break;case"right":x+=i;break;case"right-bottom":x+=i,u+=n;break;case"bottom":u+=n;break;case"bottom-left":s+=i,u+=n;break;case"left":s+=i;break;case"left-top":s+=i,a+=n;break;case"move":s+=i,a+=n,x+=i,u+=n;break}return[{x:s,y:a},{x,y:u}]}function ct({x:e,y:t},{x:r,y:o},i,n,s,a){return e>r&&([e,r]=[r,e]),t>o&&([t,o]=[o,t]),e<0&&(e=0,a==="move"&&(r=i.width)),r>n&&(r=n,a==="move"&&(e=r-i.width)),t<0&&(t=0,a==="move"&&(o=i.height)),o>s&&(o=s,a==="move"&&(t=o-i.height)),{x:e,y:t,width:Math.max(r-e,1),height:Math.max(o-t,1)}}var j;(function(e){e[e.Edit=0]="Edit",e[e.Source=1]="Source"})(j||(j={}));function Z(){const{emiterRef:e}=$(),t=c.exports.useCallback((n,s)=>{const a=e.current;Array.isArray(a[n])?a[n].push(s):a[n]=[s]},[e]),r=c.exports.useCallback((n,s)=>{const a=e.current;if(Array.isArray(a[n])){const x=a[n].findIndex(u=>u===s);x!==-1&&a[n].splice(x,1)}},[e]),o=c.exports.useCallback((n,...s)=>{const a=e.current;Array.isArray(a[n])&&a[n].forEach(x=>x(...s))},[e]),i=c.exports.useCallback(()=>{e.current={}},[e]);return{on:t,off:r,emit:o,reset:i}}function H(){const{history:e}=$(),{setHistory:t}=oe(),r=c.exports.useCallback(p=>{const{index:l,stack:h}=e;h.forEach(f=>{f.type===j.Source&&(f.isSelected=!1)}),p.type===j.Source?p.isSelected=!0:p.type===j.Edit&&(p.source.isSelected=!0),h.splice(l+1),h.push(p),t==null||t({index:h.length-1,stack:h})},[e,t]),o=c.exports.useCallback(()=>{const{stack:p}=e;p.pop(),t==null||t({index:p.length-1,stack:p})},[e,t]),i=c.exports.useCallback(()=>{const{index:p,stack:l}=e,h=l[p];h&&(h.type===j.Source?h.isSelected=!1:h.type===j.Edit&&h.source.editHistory.pop()),t==null||t({index:p<=0?-1:p-1,stack:l})},[e,t]),n=c.exports.useCallback(()=>{const{index:p,stack:l}=e,h=l[p+1];h&&(h.type===j.Source?h.isSelected=!1:h.type===j.Edit&&h.source.editHistory.push(h)),t==null||t({index:p>=l.length-1?l.length-1:p+1,stack:l})},[e,t]),s=c.exports.useCallback(p=>{t==null||t(T({},p))},[t]),a=c.exports.useCallback(p=>{e.stack.forEach(l=>{l.type===j.Source&&(l===p?l.isSelected=!0:l.isSelected=!1)}),t==null||t(T({},e))},[e,t]),x=c.exports.useCallback(()=>{e.stack.forEach(p=>{p.type===j.Source&&(p.isSelected=!1)}),t==null||t(T({},e))},[e,t]),u=c.exports.useCallback(()=>{t==null||t({index:-1,stack:[]})},[t]);return[{index:e.index,stack:e.stack,top:e.stack.slice(e.index,e.index+1)[0]},{push:r,pop:o,undo:i,redo:n,set:s,select:a,clearSelect:x,reset:u}]}function G(){const{cursor:e}=$(),{setCursor:t}=oe(),r=c.exports.useCallback(i=>{t==null||t(i)},[t]),o=c.exports.useCallback(()=>{t==null||t("move")},[t]);return[e,{set:r,reset:o}]}function A(){const{operation:e}=$(),{setOperation:t}=oe(),r=c.exports.useCallback(i=>{t==null||t(i)},[t]),o=c.exports.useCallback(()=>{t==null||t(void 0)},[t]);return[e,{set:r,reset:o}]}function at(e,t,r,o){if(!t)return!1;const i=document.createElement("canvas");i.width=e.width,i.height=e.height;const n=i.getContext("2d");if(!n)return!1;const{left:s,top:a}=t.getBoundingClientRect(),x=o.clientX-s,u=o.clientY-a;return[...r.stack.slice(0,r.index+1)].reverse().find(l=>{var h;return l.type!==j.Source?!1:(n.clearRect(0,0,e.width,e.height),(h=l.isHit)==null?void 0:h.call(l,n,l,{x,y:u}))})}var ie="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsCanvas/index.tsx";const ut=["top","right","bottom","left"];var P;(function(e){e.ResizeTop="top",e.ResizetopRight="top-right",e.ResizeRight="right",e.ResizeRightBottom="right-bottom",e.ResizeBottom="bottom",e.ResizeBottomLeft="bottom-left",e.ResizeLeft="left",e.ResizeLeftTop="left-top",e.Move="move"})(P||(P={}));const lt=[P.ResizeTop,P.ResizetopRight,P.ResizeRight,P.ResizeRightBottom,P.ResizeBottom,P.ResizeBottomLeft,P.ResizeLeft,P.ResizeLeftTop];var ft=c.exports.forwardRef(function(t,r){const{image:o,width:i,height:n}=$(),s=Z(),[a]=H(),[x]=G(),[u,p]=U(),[l]=A(),h=c.exports.useRef(),f=c.exports.useRef(null),m=c.exports.useRef(null),y=c.exports.useRef(null),N=c.exports.useRef(null),w=c.exports.useCallback(()=>{if(!o||!u||!N.current)return;const d=o.naturalWidth/i,g=o.naturalHeight/n,v=N.current;v.imageSmoothingEnabled=!0,v.imageSmoothingQuality="high",v.setTransform(me,0,0,me,0,0),v.clearRect(0,0,u.width,u.height),v.drawImage(o,u.x*d,u.y*g,u.width*d,u.height*g,0,0,u.width,u.height),a.stack.slice(0,a.index+1).forEach(C=>{C.type===j.Source&&C.draw(v,C)})},[o,i,n,u,N,a]),S=c.exports.useCallback((d,g)=>{if(!(d.button!==0||!u))if(!l)h.current=g,f.current={x:d.clientX,y:d.clientY},m.current={x:u.x,y:u.y,width:u.width,height:u.height};else{const v=at(u,y.current,a,d.nativeEvent);v?s.emit("drawselect",v,d.nativeEvent):s.emit("mousedown",d.nativeEvent)}},[u,l,s,a]),z=c.exports.useCallback(d=>{if(!h.current||!f.current||!m.current||!u)return;const g=it(d,h.current,f.current,m.current);p.set(ct(g[0],g[1],u,i,n,h.current))},[i,n,u,p]);return c.exports.useLayoutEffect(()=>{if(!o||!u||!y.current){N.current=null;return}N.current||(N.current=y.current.getContext("2d")),w()},[o,u,w]),c.exports.useEffect(()=>{const d=v=>{if(l)s.emit("mousemove",v);else{if(!h.current||!f.current||!m.current)return;z(v)}},g=v=>{if(l)s.emit("mouseup",v);else{if(!h.current||!f.current||!m.current)return;z(v),h.current=void 0,f.current=null,m.current=null}};return window.addEventListener("mousemove",d),window.addEventListener("mouseup",g),()=>{window.removeEventListener("mousemove",d),window.removeEventListener("mouseup",g)}},[z,l,s]),c.exports.useImperativeHandle(r,()=>N.current),u?b.exports.jsxDEV("div",{className:"screenshots-canvas",style:{left:u.x,top:u.y,width:u.width,height:u.height},children:[b.exports.jsxDEV("canvas",{ref:y,width:u.width*me,height:u.height*me,style:{width:u.width,height:u.height}},void 0,!1,{fileName:ie,lineNumber:199,columnNumber:7},this),b.exports.jsxDEV("div",{className:"screenshots-canvas-body",style:{cursor:x},onMouseDown:d=>S(d,"move")},void 0,!1,{fileName:ie,lineNumber:208,columnNumber:7},this),ut.map(d=>b.exports.jsxDEV("div",{className:`screenshots-canvas-border-${d}`},d,!1,{fileName:ie,lineNumber:216,columnNumber:16},this)),lt.map(d=>b.exports.jsxDEV("div",{className:`screenshots-canvas-point-${d}`,onMouseDown:g=>S(g,d)},d,!1,{fileName:ie,lineNumber:220,columnNumber:11},this))]},void 0,!0,{fileName:ie,lineNumber:190,columnNumber:5},this):null});function Ne(){const e=oe();return c.exports.useCallback((r,...o)=>{var i;(i=e.call)==null||i.call(e,r,...o)},[e])}function I(){const{canvasContextRef:e}=$();return e}function Ce(){const e=Z(),[,t]=U(),[,r]=G(),[,o]=H(),[,i]=A();return c.exports.useCallback(()=>{e.reset(),o.reset(),t.reset(),r.reset(),i.reset()},[e,o,t,r,i])}var Se="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsOption/index.tsx",J;(function(e){e.Bottom="bottom",e.Top="top"})(J||(J={}));function ht({open:e,content:t,children:r}){const o=c.exports.useRef(null),i=c.exports.useRef(null),n=c.exports.useRef(null),s=c.exports.useContext(Oe),[a,x]=c.exports.useState(J.Bottom),[u,p]=c.exports.useState(null),[l,h]=c.exports.useState(0),f=()=>(i.current||(i.current=document.createElement("div")),i.current);return c.exports.useEffect(()=>{const m=f();return e&&document.body.appendChild(m),()=>{m.remove()}},[e]),c.exports.useEffect(()=>{if(!e||!s||!o.current||!n.current)return;const m=o.current.getBoundingClientRect(),y=n.current.getBoundingClientRect();let N=a,w=m.left+m.width/2,S=m.top+m.height,z=l;if(w+y.width/2>s.x+s.width){const d=w;w=s.x+s.width-y.width/2,z=d-w}if(w<s.x+y.width/2){const d=w;w=s.x+y.width/2,z=d-w}S>window.innerHeight-y.height&&(N===J.Bottom&&(N=J.Top),S=m.top-y.height),S<0&&(N===J.Top&&(N=J.Bottom),S=m.top+m.height),N!==a&&x(N),((u==null?void 0:u.x)!==w||u.y!==S)&&p({x:w,y:S}),z!==l&&h(z)}),b.exports.jsxDEV(b.exports.Fragment,{children:[c.exports.cloneElement(r,{ref:o}),e&&t&&Ve.exports.createPortal(b.exports.jsxDEV("div",{ref:n,className:"screenshots-option",style:{visibility:u?"visible":"hidden",left:u==null?void 0:u.x,top:u==null?void 0:u.y},"data-placement":a,children:[b.exports.jsxDEV("div",{className:"screenshots-option-container",children:t},void 0,!1,{fileName:Se,lineNumber:121,columnNumber:13},this),b.exports.jsxDEV("div",{className:"screenshots-option-arrow",style:{marginLeft:l}},void 0,!1,{fileName:Se,lineNumber:122,columnNumber:13},this)]},void 0,!0,{fileName:Se,lineNumber:111,columnNumber:11},this),f())]},void 0,!0)}var Re="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsButton/index.tsx";function X({title:e,icon:t,checked:r,disabled:o,option:i,onClick:n}){const s=["screenshots-button"],a=c.exports.useCallback(x=>{o||!n||n(x)},[o,n]);return r&&s.push("screenshots-button-checked"),o&&s.push("screenshots-button-disabled"),b.exports.jsxDEV(ht,{open:r,content:i,children:b.exports.jsxDEV("div",{className:s.join(" "),title:e,onClick:a,children:b.exports.jsxDEV("span",{className:t},void 0,!1,{fileName:Re,lineNumber:44,columnNumber:9},this)},void 0,!1,{fileName:Re,lineNumber:43,columnNumber:7},this)},void 0,!1,{fileName:Re,lineNumber:42,columnNumber:5},this)}var pt="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Ok/index.tsx";function mt(){const e=L(),t=I(),[,r]=H(),o=Ne(),[i]=U(),n=Ce(),s=c.exports.useCallback(()=>{r.clearSelect(),setTimeout(()=>{!t.current||t.current.canvas.toBlob(a=>{o("onOk",a,i),n()},"image/png")})},[t,r,o,i,n]);return b.exports.jsxDEV(X,{title:e.operation_ok_title,icon:"icon-ok",onClick:s},void 0,!1,{fileName:pt,lineNumber:31,columnNumber:10},this)}var dt="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Cancel/index.tsx";function xt(){const e=Ne(),t=Ce(),r=L(),o=c.exports.useCallback(()=>{e("onCancel"),t()},[e,t]);return b.exports.jsxDEV(X,{title:r.operation_cancel_title,icon:"icon-cancel",onClick:o},void 0,!1,{fileName:dt,lineNumber:17,columnNumber:10},this)}var gt="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Save/index.tsx";function bt(){const e=L(),t=I(),[,r]=H(),[o]=U(),i=Ne(),n=Ce(),s=c.exports.useCallback(()=>{r.clearSelect(),setTimeout(()=>{!t.current||t.current.canvas.toBlob(a=>{i("onSave",a,o),n()},"image/png")})},[t,r,o,i,n]);return b.exports.jsxDEV(X,{title:e.operation_save_title,icon:"icon-save",onClick:s},void 0,!1,{fileName:gt,lineNumber:31,columnNumber:10},this)}var vt="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Redo/index.tsx";function yt(){const e=L(),[t,r]=H(),o=c.exports.useCallback(()=>{r.redo()},[r]);return b.exports.jsxDEV(X,{title:e.operation_redo_title,icon:"icon-redo",disabled:!t.stack.length||t.stack.length-1===t.index,onClick:o},void 0,!1,{fileName:vt,lineNumber:15,columnNumber:5},this)}var Nt="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Undo/index.tsx";function Ct(){const e=L(),[t,r]=H(),o=c.exports.useCallback(()=>{r.undo()},[r]);return b.exports.jsxDEV(X,{title:e.operation_undo_title,icon:"icon-undo",disabled:t.index===-1,onClick:o},void 0,!1,{fileName:Nt,lineNumber:15,columnNumber:5},this)}var ke="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsSize/index.tsx";function He({value:e,onChange:t}){const r=[3,6,9];return b.exports.jsxDEV("div",{className:"screenshots-size",children:r.map(o=>{const i=["screenshots-size-item"];return o===e&&i.push("screenshots-size-active"),b.exports.jsxDEV("div",{className:i.join(" "),onClick:()=>t&&t(o),children:b.exports.jsxDEV("div",{className:"screenshots-size-pointer",style:{width:o*1.8,height:o*1.8}},void 0,!1,{fileName:ke,lineNumber:22,columnNumber:13},this)},o,!1,{fileName:ke,lineNumber:21,columnNumber:11},this)})},void 0,!1,{fileName:ke,lineNumber:12,columnNumber:5},this)}function ee(e){const t=Z();c.exports.useEffect(()=>(t.on("mousedown",e),()=>{t.off("mousedown",e)}),[e,t])}function te(e){const t=Z();c.exports.useEffect(()=>(t.on("mousemove",e),()=>{t.off("mousemove",e)}),[e,t])}function se(e){const t=Z();c.exports.useEffect(()=>(t.on("mouseup",e),()=>{t.off("mouseup",e)}),[e,t])}var Xe="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Mosaic/index.tsx";function de(e,t,r){if(!r)return[0,0,0,0];const{data:o,width:i}=r,n=t*i*4+e*4;return Array.from(o.slice(n,n+4))}function St(e,t){const{tiles:r,size:o}=t.data;r.forEach(i=>{const n=Math.round(i.color[0]),s=Math.round(i.color[1]),a=Math.round(i.color[2]),x=i.color[3]/255;e.fillStyle=`rgba(${n}, ${s}, ${a}, ${x})`,e.fillRect(i.x-o/2,i.y-o/2,o,o)})}function Rt(){const e=L(),{image:t,width:r,height:o}=$(),[i,n]=A(),s=I(),[a,x]=H(),[u]=U(),[,p]=G(),[l,h]=c.exports.useState(3),f=c.exports.useRef(null),m=c.exports.useRef(null),y=i==="Mosaic",N=c.exports.useCallback(()=>{n.set("Mosaic"),p.set("crosshair")},[n,p]),w=c.exports.useCallback(()=>{y||(N(),x.clearSelect())},[y,N,x]),S=c.exports.useCallback(g=>{if(!y||m.current||!f.current||!s.current)return;const v=s.current.canvas.getBoundingClientRect(),C=g.clientX-v.x,k=g.clientY-v.y,E=l*2;m.current={name:"Mosaic",type:j.Source,data:{size:E,tiles:[{x:C,y:k,color:de(C,k,f.current)}]},editHistory:[],draw:St}},[y,l,s]),z=c.exports.useCallback(g=>{if(!y||!m.current||!s.current||!f.current)return;const v=s.current.canvas.getBoundingClientRect(),C=g.clientX-v.x,k=g.clientY-v.y,E=m.current.data.size,D=m.current.data.tiles;let R=D[D.length-1];if(!R)D.push({x:C,y:k,color:de(C,k,f.current)});else{const O=R.x-C,B=R.y-k;let V=Math.sqrt(O**2+B**2);const ge=-B/V,be=-O/V;for(;V>E;){const ne=Math.floor(R.x+E*be),re=Math.floor(R.y+E*ge);R={x:ne,y:re,color:de(ne,re,f.current)},D.push(R),V-=E}V>E/2&&D.push({x:C,y:k,color:de(C,k,f.current)})}a.top!==m.current?x.push(m.current):x.set(a)},[y,s,a,x]),d=c.exports.useCallback(()=>{!y||(m.current=null)},[y]);return ee(S),te(z),se(d),c.exports.useEffect(()=>{if(!u||!t||!y)return;const g=document.createElement("canvas"),v=g.getContext("2d");if(!v)return;g.width=u.width,g.height=u.height;const C=t.naturalWidth/r,k=t.naturalHeight/o;v.drawImage(t,u.x*C,u.y*k,u.width*C,u.height*k,0,0,u.width,u.height),f.current=v.getImageData(0,0,u.width,u.height)},[r,o,u,t,y]),b.exports.jsxDEV(X,{title:e.operation_mosaic_title,icon:"icon-mosaic",checked:y,onClick:w,option:b.exports.jsxDEV(He,{value:l,onChange:h},void 0,!1,{fileName:Xe,lineNumber:220,columnNumber:15},this)},void 0,!1,{fileName:Xe,lineNumber:215,columnNumber:5},this)}var Fe="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsColor/index.tsx";function kt({value:e,onChange:t}){const r=["#ee5126","#fceb4d","#90e746","#51c0fa","#7a7a7a","#ffffff"];return b.exports.jsxDEV("div",{className:"screenshots-color",children:r.map(o=>{const i=["screenshots-color-item"];return o===e&&i.push("screenshots-color-active"),b.exports.jsxDEV("div",{className:i.join(" "),style:{backgroundColor:o},onClick:()=>t&&t(o)},o,!1,{fileName:Fe,lineNumber:19,columnNumber:11},this)})},void 0,!1,{fileName:Fe,lineNumber:12,columnNumber:5},this)}var we="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsSizeColor/index.tsx";function ce({size:e,color:t,onSizeChange:r,onColorChange:o}){return b.exports.jsxDEV("div",{className:"screenshots-sizecolor",children:[b.exports.jsxDEV(He,{value:e,onChange:r},void 0,!1,{fileName:we,lineNumber:16,columnNumber:7},this),b.exports.jsxDEV(kt,{value:t,onChange:o},void 0,!1,{fileName:we,lineNumber:17,columnNumber:7},this)]},void 0,!0,{fileName:we,lineNumber:15,columnNumber:5},this)}const wt=`
min-width: 0 !important;
width: 0 !important;
min-height: 0 !important;
height:0 !important;
visibility: hidden !important;
overflow: hidden !important;
position: absolute !important;
z-index: -1000 !important;
top:0 !important;
right:0 !important;
`,Dt=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","text-indent","padding-left","padding-right","border-width","box-sizing","white-space","word-break"];let W;function zt(e){const t=window.getComputedStyle(e),r=t.getPropertyValue("box-sizing")||t.getPropertyValue("-moz-box-sizing")||t.getPropertyValue("-webkit-box-sizing"),o=parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),i=parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width"));return{sizingStyle:Dt.map(s=>`${s}:${t.getPropertyValue(s)}`).join(";"),paddingSize:o,borderSize:i,boxSizing:r}}function Et(e,t,r,o){W||(W=document.createElement("textarea"),W.setAttribute("tab-index","-1"),document.body.appendChild(W));const{paddingSize:i,borderSize:n,boxSizing:s,sizingStyle:a}=zt(e);W.setAttribute("style",`${a};${wt};max-width:${r}px;max-height:${o}px`),W.value=t||" ";let x=W.scrollWidth,u=W.scrollHeight;return s==="border-box"?(x+=n,u+=n):s==="content-box"&&(x-=i,u-=i),{width:Math.min(x,r),height:Math.min(u,o)}}var jt="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsTextarea/index.tsx";function Bt({x:e,y:t,maxWidth:r,maxHeight:o,size:i,color:n,value:s,onChange:a,onBlur:x}){const u=c.exports.useRef(null),p=c.exports.useRef(null),[l,h]=c.exports.useState(0),[f,m]=c.exports.useState(0),y=()=>(u.current||(u.current=document.createElement("div")),u.current);return c.exports.useLayoutEffect(()=>(u.current&&(document.body.appendChild(u.current),requestAnimationFrame(()=>{var N;(N=p.current)==null||N.focus()})),()=>{var N;(N=u.current)==null||N.remove()}),[]),c.exports.useLayoutEffect(()=>{if(!p.current)return;const{width:N,height:w}=Et(p.current,s,r,o);h(N),m(w)},[s,r,o]),Ve.exports.createPortal(b.exports.jsxDEV("textarea",{ref:p,className:"screenshots-textarea",style:{left:e,top:t,color:n,width:l,height:f,maxWidth:r,maxHeight:o,fontSize:i,lineHeight:`${i}px`},value:s,onChange:N=>a&&a(N.target.value),onBlur:N=>x&&x(N)},void 0,!1,{fileName:jt,lineNumber:65,columnNumber:5},this),y())}function ae(e){const t=Z();c.exports.useEffect(()=>(t.on("drawselect",e),()=>{t.off("drawselect",e)}),[e,t])}var De="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Text/index.tsx";const ze={3:18,6:32,9:46};function Mt(e,t){const{size:r,color:o,fontFamily:i,x:n,y:s,text:a}=t.data;e.fillStyle=o,e.textAlign="left",e.textBaseline="top",e.font=`${r}px ${i}`;const x=t.editHistory.reduce((u,{data:p})=>({x:u.x+p.x2-p.x1,y:u.y+p.y2-p.y1}),{x:0,y:0});a.split(`
`).forEach((u,p)=>{e.fillText(u,n+x.x,s+x.y+p*r)})}function _t(e,t,r){e.textAlign="left",e.textBaseline="top",e.font=`${t.data.size}px ${t.data.fontFamily}`;let o=0,i=0;t.data.text.split(`
`).forEach(l=>{const h=e.measureText(l);o<h.width&&(o=h.width),i+=t.data.size});const{x:n,y:s}=t.editHistory.reduce((l,{data:h})=>({x:l.x+h.x2-h.x1,y:l.y+h.y2-h.y1}),{x:0,y:0}),a=t.data.x+n,x=t.data.y+s,u=a+o,p=x+i;return r.x>=a&&r.x<=u&&r.y>=x&&r.y<=p}function Vt(){const e=L(),[t,r]=H(),[o]=U(),[i,n]=A(),[,s]=G(),a=I(),[x,u]=c.exports.useState(3),[p,l]=c.exports.useState("#ee5126"),h=c.exports.useRef(null),f=c.exports.useRef(null),[m,y]=c.exports.useState(null),[N,w]=c.exports.useState(""),S=i==="Text",z=c.exports.useCallback(()=>{n.set("Text"),s.set("default")},[n,s]),d=c.exports.useCallback(()=>{S||(z(),r.clearSelect())},[S,z,r]),g=c.exports.useCallback(B=>{h.current&&(h.current.data.size=ze[B]),u(B)},[]),v=c.exports.useCallback(B=>{h.current&&(h.current.data.color=B),l(B)},[]),C=c.exports.useCallback(B=>{w(B),S&&h.current&&(h.current.data.text=B)},[S]),k=c.exports.useCallback(()=>{h.current&&h.current.data.text&&r.push(h.current),h.current=null,w(""),y(null)},[r]),E=c.exports.useCallback((B,V)=>{B.name==="Text"&&(z(),f.current={type:j.Edit,data:{x1:V.clientX,y1:V.clientY,x2:V.clientX,y2:V.clientY},source:B},r.select(B))},[z,r]),D=c.exports.useCallback(B=>{if(!S||!a.current||h.current||!o)return;const{left:V,top:ge}=a.current.canvas.getBoundingClientRect(),be=window.getComputedStyle(a.current.canvas).fontFamily,ne=B.clientX-V,re=B.clientY-ge;h.current={name:"Text",type:j.Source,data:{size:ze[x],color:p,fontFamily:be,x:ne,y:re,text:""},editHistory:[],draw:Mt,isHit:_t},y({x:B.clientX,y:B.clientY,maxWidth:o.width-ne,maxHeight:o.height-re})},[S,x,p,o,a]),R=c.exports.useCallback(B=>{!S||f.current&&(f.current.data.x2=B.clientX,f.current.data.y2=B.clientY,t.top!==f.current?(f.current.source.editHistory.push(f.current),r.push(f.current)):r.set(t))},[S,t,r]),O=c.exports.useCallback(()=>{!S||(f.current=null)},[S]);return ae(E),ee(D),te(R),se(O),b.exports.jsxDEV(b.exports.Fragment,{children:[b.exports.jsxDEV(X,{title:e.operation_text_title,icon:"icon-text",checked:S,onClick:d,option:b.exports.jsxDEV(ce,{size:x,color:p,onSizeChange:g,onColorChange:v},void 0,!1,{fileName:De,lineNumber:261,columnNumber:11},this)},void 0,!1,{fileName:De,lineNumber:255,columnNumber:7},this),S&&m&&b.exports.jsxDEV(Bt,{x:m.x,y:m.y,maxWidth:m.maxWidth,maxHeight:m.maxHeight,size:ze[x],color:p,value:N,onChange:C,onBlur:k},void 0,!1,{fileName:De,lineNumber:265,columnNumber:9},this)]},void 0,!0)}const Ye=4;function M(e,t,r){e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",e.beginPath(),e.arc(t,r,Ye,0,2*Math.PI),e.fill(),e.stroke()}function xe(e,t,r){t.draw(e,t);const{data:o}=e.getImageData(r.x,r.y,1,1);return o.some(i=>i!==0)}function _(e,t,r){if(!e)return!1;const{left:o,top:i}=e.getBoundingClientRect(),n=t.clientX-o,s=t.clientY-i;return(r.x-n)**2+(r.y-s)**2<Ye**2}function $t(e,t){const{size:r,color:o,points:i}=t.data;e.lineCap="round",e.lineJoin="round",e.lineWidth=r,e.strokeStyle=o;const n=t.editHistory.reduce((s,{data:a})=>({x:s.x+a.x2-a.x1,y:s.y+a.y2-a.y1}),{x:0,y:0});e.beginPath(),i.forEach((s,a)=>{a===0?e.moveTo(s.x+n.x,s.y+n.y):e.lineTo(s.x+n.x,s.y+n.y)}),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.beginPath(),i.forEach((s,a)=>{a===0?e.moveTo(s.x+n.x,s.y+n.y):e.lineTo(s.x+n.x,s.y+n.y)}),e.stroke())}var Pe="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Brush/index.tsx";function Lt(){const e=L(),[,t]=G(),[r,o]=A(),i=I(),[n,s]=H(),[a,x]=c.exports.useState(3),[u,p]=c.exports.useState("#ee5126"),l=c.exports.useRef(null),h=c.exports.useRef(null),f=r==="Brush",m=c.exports.useCallback(()=>{o.set("Brush"),t.set("default")},[o,t]),y=c.exports.useCallback(()=>{f||(m(),s.clearSelect())},[f,m,s]),N=c.exports.useCallback((d,g)=>{d.name==="Brush"&&(m(),h.current={type:j.Edit,data:{x1:g.clientX,y1:g.clientY,x2:g.clientX,y2:g.clientY},source:d},s.select(d))},[m,s]),w=c.exports.useCallback(d=>{if(!f||l.current||!i.current)return;const{left:g,top:v}=i.current.canvas.getBoundingClientRect();l.current={name:"Brush",type:j.Source,data:{size:a,color:u,points:[{x:d.clientX-g,y:d.clientY-v}]},editHistory:[],draw:$t,isHit:xe}},[f,i,a,u]),S=c.exports.useCallback(d=>{if(!(!f||!i.current)){if(h.current)h.current.data.x2=d.clientX,h.current.data.y2=d.clientY,n.top!==h.current?(h.current.source.editHistory.push(h.current),s.push(h.current)):s.set(n);else if(l.current){const{left:g,top:v}=i.current.canvas.getBoundingClientRect();l.current.data.points.push({x:d.clientX-g,y:d.clientY-v}),n.top!==l.current?s.push(l.current):s.set(n)}}},[f,n,i,s]),z=c.exports.useCallback(()=>{!f||(l.current&&s.clearSelect(),l.current=null,h.current=null)},[f,s]);return ae(N),ee(w),te(S),se(z),b.exports.jsxDEV(X,{title:e.operation_brush_title,icon:"icon-brush",checked:f,onClick:y,option:b.exports.jsxDEV(ce,{size:a,color:u,onSizeChange:x,onColorChange:p},void 0,!1,{fileName:Pe,lineNumber:166,columnNumber:15},this)},void 0,!1,{fileName:Pe,lineNumber:161,columnNumber:5},this)}function Te(e){let{x1:t,y1:r,x2:o,y2:i}=e.data;return e.editHistory.forEach(({data:n})=>{const s=n.x2-n.x1,a=n.y2-n.y1;n.type===ue.Move?(t+=s,r+=a,o+=s,i+=a):n.type===ue.MoveStart?(t+=s,r+=a):n.type===ue.MoveEnd&&(o+=s,i+=a)}),pe(T({},e.data),{x1:t,x2:o,y1:r,y2:i})}function Ht(e,t){const{size:r,color:o,x1:i,x2:n,y1:s,y2:a}=Te(t);e.lineCap="round",e.lineJoin="bevel",e.lineWidth=r,e.strokeStyle=o;const x=n-i,u=a-s,p=r*3,l=Math.atan2(u,x);e.beginPath(),e.moveTo(i,s),e.lineTo(n,a),e.lineTo(n-p*Math.cos(l-Math.PI/6),a-p*Math.sin(l-Math.PI/6)),e.moveTo(n,a),e.lineTo(n-p*Math.cos(l+Math.PI/6),a-p*Math.sin(l+Math.PI/6)),e.stroke(),t.isSelected&&(M(e,i,s),M(e,n,a))}var Ue="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Arrow/index.tsx",ue;(function(e){e[e.Move=0]="Move",e[e.MoveStart=1]="MoveStart",e[e.MoveEnd=2]="MoveEnd"})(ue||(ue={}));function Xt(){const e=L(),[,t]=G(),[r,o]=A(),[i,n]=H(),s=I(),[a,x]=c.exports.useState(3),[u,p]=c.exports.useState("#ee5126"),l=c.exports.useRef(null),h=c.exports.useRef(null),f=r==="Arrow",m=c.exports.useCallback(()=>{o.set("Arrow"),t.set("default")},[o,t]),y=c.exports.useCallback(()=>{f||(m(),n.clearSelect())},[f,m,n]),N=c.exports.useCallback((d,g)=>{if(d.name!=="Arrow"||!s.current)return;const v=d;m();const{x1:C,y1:k,x2:E,y2:D}=Te(v);let R=0;_(s.current.canvas,g,{x:C,y:k})?R=1:_(s.current.canvas,g,{x:E,y:D})&&(R=2),h.current={type:j.Edit,data:{type:R,x1:g.clientX,y1:g.clientY,x2:g.clientX,y2:g.clientY},source:v},n.select(d)},[s,m,n]),w=c.exports.useCallback(d=>{if(!f||l.current||!s.current)return;const{left:g,top:v}=s.current.canvas.getBoundingClientRect();l.current={name:"Arrow",type:j.Source,data:{size:a,color:u,x1:d.clientX-g,y1:d.clientY-v,x2:d.clientX-g,y2:d.clientY-v},editHistory:[],draw:Ht,isHit:xe}},[f,u,a,s]),S=c.exports.useCallback(d=>{if(!(!f||!s.current)){if(h.current)h.current.data.x2=d.clientX,h.current.data.y2=d.clientY,i.top!==h.current?(h.current.source.editHistory.push(h.current),n.push(h.current)):n.set(i);else if(l.current){const{left:g,top:v}=s.current.canvas.getBoundingClientRect();l.current.data.x2=d.clientX-g,l.current.data.y2=d.clientY-v,i.top!==l.current?n.push(l.current):n.set(i)}}},[f,i,s,n]),z=c.exports.useCallback(()=>{!f||(l.current&&n.clearSelect(),l.current=null,h.current=null)},[f,n]);return ae(N),ee(w),te(S),se(z),b.exports.jsxDEV(X,{title:e.operation_arrow_title,icon:"icon-arrow",checked:f,onClick:y,option:b.exports.jsxDEV(ce,{size:a,color:u,onSizeChange:x,onColorChange:p},void 0,!1,{fileName:Ue,lineNumber:190,columnNumber:15},this)},void 0,!1,{fileName:Ue,lineNumber:185,columnNumber:5},this)}function Ge(e){let{x1:t,y1:r,x2:o,y2:i}=e.data;return e.editHistory.forEach(({data:n})=>{const s=n.x2-n.x1,a=n.y2-n.y1;n.type===F.Move?(t+=s,r+=a,o+=s,i+=a):n.type===F.ResizeTop?r+=a:n.type===F.ResizeRightTop?(o+=s,r+=a):n.type===F.ResizeRight?o+=s:n.type===F.ResizeRightBottom?(o+=s,i+=a):n.type===F.ResizeBottom?i+=a:n.type===F.ResizeLeftBottom?(t+=s,i+=a):n.type===F.ResizeLeft?t+=s:n.type===F.ResizeLeftTop&&(t+=s,r+=a)}),pe(T({},e.data),{x1:t,x2:o,y1:r,y2:i})}function Ft(e,t){const{size:r,color:o,x1:i,y1:n,x2:s,y2:a}=Ge(t);e.lineCap="butt",e.lineJoin="miter",e.lineWidth=r,e.strokeStyle=o;const x=(i+s)/2,u=(n+a)/2,p=Math.abs(s-i)/2,l=Math.abs(a-n)/2,h=.5522848,f=p*h,m=l*h;e.beginPath(),e.moveTo(x-p,u),e.bezierCurveTo(x-p,u-m,x-f,u-l,x,u-l),e.bezierCurveTo(x+f,u-l,x+p,u-m,x+p,u),e.bezierCurveTo(x+p,u+m,x+f,u+l,x,u+l),e.bezierCurveTo(x-f,u+l,x-p,u+m,x-p,u),e.closePath(),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",e.beginPath(),e.moveTo(i,n),e.lineTo(s,n),e.lineTo(s,a),e.lineTo(i,a),e.closePath(),e.stroke(),M(e,(i+s)/2,n),M(e,s,n),M(e,s,(n+a)/2),M(e,s,a),M(e,(i+s)/2,a),M(e,i,a),M(e,i,(n+a)/2),M(e,i,n))}var Ae="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Ellipse/index.tsx",F;(function(e){e[e.Move=0]="Move",e[e.ResizeTop=1]="ResizeTop",e[e.ResizeRightTop=2]="ResizeRightTop",e[e.ResizeRight=3]="ResizeRight",e[e.ResizeRightBottom=4]="ResizeRightBottom",e[e.ResizeBottom=5]="ResizeBottom",e[e.ResizeLeftBottom=6]="ResizeLeftBottom",e[e.ResizeLeft=7]="ResizeLeft",e[e.ResizeLeftTop=8]="ResizeLeftTop"})(F||(F={}));function Yt(){const e=L(),[t,r]=H(),[o,i]=A(),[,n]=G(),s=I(),[a,x]=c.exports.useState(3),[u,p]=c.exports.useState("#ee5126"),l=c.exports.useRef(null),h=c.exports.useRef(null),f=o==="Ellipse",m=c.exports.useCallback(()=>{i.set("Ellipse"),n.set("crosshair")},[i,n]),y=c.exports.useCallback(()=>{f||(m(),r.clearSelect())},[f,m,r]),N=c.exports.useCallback((d,g)=>{if(d.name!=="Ellipse"||!s.current)return;const v=d;m();const{x1:C,y1:k,x2:E,y2:D}=Ge(v);let R=0;_(s.current.canvas,g,{x:(C+E)/2,y:k})?R=1:_(s.current.canvas,g,{x:E,y:k})?R=2:_(s.current.canvas,g,{x:E,y:(k+D)/2})?R=3:_(s.current.canvas,g,{x:E,y:D})?R=4:_(s.current.canvas,g,{x:(C+E)/2,y:D})?R=5:_(s.current.canvas,g,{x:C,y:D})?R=6:_(s.current.canvas,g,{x:C,y:(k+D)/2})?R=7:_(s.current.canvas,g,{x:C,y:k})&&(R=8),h.current={type:j.Edit,data:{type:R,x1:g.clientX,y1:g.clientY,x2:g.clientX,y2:g.clientY},source:v},r.select(d)},[s,m,r]),w=c.exports.useCallback(d=>{if(!f||!s.current||l.current)return;const{left:g,top:v}=s.current.canvas.getBoundingClientRect(),C=d.clientX-g,k=d.clientY-v;l.current={name:"Ellipse",type:j.Source,data:{size:a,color:u,x1:C,y1:k,x2:C,y2:k},editHistory:[],draw:Ft,isHit:xe}},[f,a,u,s]),S=c.exports.useCallback(d=>{if(!(!f||!s.current)){if(h.current)h.current.data.x2=d.clientX,h.current.data.y2=d.clientY,t.top!==h.current?(h.current.source.editHistory.push(h.current),r.push(h.current)):r.set(t);else if(l.current){const{left:g,top:v}=s.current.canvas.getBoundingClientRect();l.current.data.x2=d.clientX-g,l.current.data.y2=d.clientY-v,t.top!==l.current?r.push(l.current):r.set(t)}}},[f,s,t,r]),z=c.exports.useCallback(()=>{!f||(l.current&&r.clearSelect(),l.current=null,h.current=null)},[f,r]);return ae(N),ee(w),te(S),se(z),b.exports.jsxDEV(X,{title:e.operation_ellipse_title,icon:"icon-ellipse",checked:f,onClick:y,option:b.exports.jsxDEV(ce,{size:a,color:u,onSizeChange:x,onColorChange:p},void 0,!1,{fileName:Ae,lineNumber:242,columnNumber:15},this)},void 0,!1,{fileName:Ae,lineNumber:237,columnNumber:5},this)}function Ie(e){let{x1:t,y1:r,x2:o,y2:i}=e.data;return e.editHistory.forEach(({data:n})=>{const s=n.x2-n.x1,a=n.y2-n.y1;n.type===Y.Move?(t+=s,r+=a,o+=s,i+=a):n.type===Y.ResizeTop?r+=a:n.type===Y.ResizeRightTop?(o+=s,r+=a):n.type===Y.ResizeRight?o+=s:n.type===Y.ResizeRightBottom?(o+=s,i+=a):n.type===Y.ResizeBottom?i+=a:n.type===Y.ResizeLeftBottom?(t+=s,i+=a):n.type===Y.ResizeLeft?t+=s:n.type===Y.ResizeLeftTop&&(t+=s,r+=a)}),pe(T({},e.data),{x1:t,x2:o,y1:r,y2:i})}function Pt(e,t){const{size:r,color:o,x1:i,y1:n,x2:s,y2:a}=Ie(t);e.lineCap="butt",e.lineJoin="miter",e.lineWidth=r,e.strokeStyle=o,e.beginPath(),e.moveTo(i,n),e.lineTo(s,n),e.lineTo(s,a),e.lineTo(i,a),e.closePath(),e.stroke(),t.isSelected&&(e.lineWidth=1,e.strokeStyle="#000000",e.fillStyle="#ffffff",M(e,(i+s)/2,n),M(e,s,n),M(e,s,(n+a)/2),M(e,s,a),M(e,(i+s)/2,a),M(e,i,a),M(e,i,(n+a)/2),M(e,i,n))}var We="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/operations/Rectangle/index.tsx",Y;(function(e){e[e.Move=0]="Move",e[e.ResizeTop=1]="ResizeTop",e[e.ResizeRightTop=2]="ResizeRightTop",e[e.ResizeRight=3]="ResizeRight",e[e.ResizeRightBottom=4]="ResizeRightBottom",e[e.ResizeBottom=5]="ResizeBottom",e[e.ResizeLeftBottom=6]="ResizeLeftBottom",e[e.ResizeLeft=7]="ResizeLeft",e[e.ResizeLeftTop=8]="ResizeLeftTop"})(Y||(Y={}));function Tt(){const e=L(),[t,r]=H(),[o,i]=A(),[,n]=G(),s=I(),[a,x]=c.exports.useState(3),[u,p]=c.exports.useState("#ee5126"),l=c.exports.useRef(null),h=c.exports.useRef(null),f=o==="Rectangle",m=c.exports.useCallback(()=>{i.set("Rectangle"),n.set("crosshair")},[i,n]),y=c.exports.useCallback(()=>{f||(m(),r.clearSelect())},[f,m,r]),N=c.exports.useCallback((d,g)=>{if(d.name!=="Rectangle"||!s.current)return;const v=d;m();const{x1:C,y1:k,x2:E,y2:D}=Ie(v);let R=0;_(s.current.canvas,g,{x:(C+E)/2,y:k})?R=1:_(s.current.canvas,g,{x:E,y:k})?R=2:_(s.current.canvas,g,{x:E,y:(k+D)/2})?R=3:_(s.current.canvas,g,{x:E,y:D})?R=4:_(s.current.canvas,g,{x:(C+E)/2,y:D})?R=5:_(s.current.canvas,g,{x:C,y:D})?R=6:_(s.current.canvas,g,{x:C,y:(k+D)/2})?R=7:_(s.current.canvas,g,{x:C,y:k})&&(R=8),h.current={type:j.Edit,data:{type:R,x1:g.clientX,y1:g.clientY,x2:g.clientX,y2:g.clientY},source:d},r.select(d)},[s,m,r]),w=c.exports.useCallback(d=>{if(!f||!s.current||l.current)return;const{left:g,top:v}=s.current.canvas.getBoundingClientRect(),C=d.clientX-g,k=d.clientY-v;l.current={name:"Rectangle",type:j.Source,data:{size:a,color:u,x1:C,y1:k,x2:C,y2:k},editHistory:[],draw:Pt,isHit:xe}},[f,a,u,s]),S=c.exports.useCallback(d=>{if(!(!f||!s.current)){if(h.current)h.current.data.x2=d.clientX,h.current.data.y2=d.clientY,t.top!==h.current?(h.current.source.editHistory.push(h.current),r.push(h.current)):r.set(t);else if(l.current){const{left:g,top:v}=s.current.canvas.getBoundingClientRect(),C=l.current.data;C.x2=d.clientX-g,C.y2=d.clientY-v,t.top!==l.current?r.push(l.current):r.set(t)}}},[f,s,t,r]),z=c.exports.useCallback(()=>{!f||(l.current&&r.clearSelect(),l.current=null,h.current=null)},[f,r]);return ae(N),ee(w),te(S),se(z),b.exports.jsxDEV(X,{title:e.operation_rectangle_title,icon:"icon-rectangle",checked:f,onClick:y,option:b.exports.jsxDEV(ce,{size:a,color:u,onSizeChange:x,onColorChange:p},void 0,!1,{fileName:We,lineNumber:242,columnNumber:15},this)},void 0,!1,{fileName:We,lineNumber:237,columnNumber:5},this)}var Ut=[Tt,Yt,Xt,Lt,Vt,Rt,"|",Ct,yt,"|",bt,xt,mt];var le="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/ScreenshotsOperations/index.tsx";const Oe=_e.createContext(null);function Gt(){const{width:e,height:t}=$(),[r]=U(),[o,i]=c.exports.useState(null),[n,s]=c.exports.useState(null),a=c.exports.useRef(null),x=c.exports.useCallback(p=>{p.stopPropagation()},[]),u=c.exports.useCallback(p=>{p.preventDefault(),p.stopPropagation()},[]);return c.exports.useEffect(()=>{if(!r||!a.current)return;const p=a.current.getBoundingClientRect();let l=r.x+r.width-p.width,h=r.y+r.height+10;l<0&&(l=0),l>e-p.width&&(l=e-p.width),h>t-p.height&&(h=t-p.height-10),((n==null?void 0:n.x)!==l||n.y!==h)&&s({x:l,y:h}),((o==null?void 0:o.x)!==p.x||o.y!==p.y||o.width!==p.width||o.height!==p.height)&&i({x:p.x,y:p.y,width:p.width,height:p.height})}),r?b.exports.jsxDEV(Oe.Provider,{value:o,children:b.exports.jsxDEV("div",{ref:a,className:"screenshots-operations",style:{visibility:n?"visible":"hidden",left:n==null?void 0:n.x,top:n==null?void 0:n.y},onDoubleClick:x,onContextMenu:u,children:b.exports.jsxDEV("div",{className:"screenshots-operations-buttons",children:Ut.map((p,l)=>p==="|"?b.exports.jsxDEV("div",{className:"screenshots-operations-divider"},l,!1,{fileName:le,lineNumber:91,columnNumber:22},this):b.exports.jsxDEV(p,{},l,!1,{fileName:le,lineNumber:93,columnNumber:22},this))},void 0,!1,{fileName:le,lineNumber:88,columnNumber:9},this)},void 0,!1,{fileName:le,lineNumber:77,columnNumber:7},this)},void 0,!1,{fileName:le,lineNumber:76,columnNumber:5},this):null}function At(e){const[t,r]=c.exports.useState(null);return c.exports.useEffect(()=>{if(e==null)return;const o=document.createElement("img"),i=()=>r(o),n=()=>r(null);return o.addEventListener("load",i),o.addEventListener("error",n),o.src=e,()=>{o.removeEventListener("load",i),o.removeEventListener("error",n)}},[e]),t}var fe="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/Screenshots/index.tsx";function It(s){var a=s,{url:e,width:t,height:r,lang:o,className:i}=a,n=Me(a,["url","width","height","lang","className"]);const x=At(e),u=c.exports.useRef(null),p=c.exports.useRef({}),[l,h]=c.exports.useState({index:-1,stack:[]}),[f,m]=c.exports.useState(null),[y,N]=c.exports.useState("move"),[w,S]=c.exports.useState(void 0),z={url:e,width:t,height:r,image:x,lang:T(T({},$e),o),emiterRef:p,canvasContextRef:u,history:l,bounds:f,cursor:y,operation:w},d=c.exports.useCallback((D,...R)=>{const O=n[D];typeof O=="function"&&O(...R)},[n]),g={call:d,setHistory:h,setBounds:m,setCursor:N,setOperation:S},v=["screenshots"];i&&v.push(i);const C=()=>{p.current={},h({index:-1,stack:[]}),m(null),N("move"),S(void 0)},k=c.exports.useCallback(D=>{D.button!==0||!f||!u.current||u.current.canvas.toBlob(R=>{d("onOk",R,f),C()},"image/png")},[f,d]),E=c.exports.useCallback(D=>{D.button===2&&(D.preventDefault(),d("onCancel"),C())},[d]);return b.exports.jsxDEV(ve.Provider,{value:{store:z,dispatcher:g},children:b.exports.jsxDEV("div",{className:v.join(" "),style:{width:t,height:r},onDoubleClick:k,onContextMenu:E,children:[b.exports.jsxDEV(ot,{},void 0,!1,{fileName:fe,lineNumber:118,columnNumber:9},this),b.exports.jsxDEV(ft,{ref:u},void 0,!1,{fileName:fe,lineNumber:119,columnNumber:9},this),b.exports.jsxDEV(Gt,{},void 0,!1,{fileName:fe,lineNumber:120,columnNumber:9},this)]},void 0,!0,{fileName:fe,lineNumber:112,columnNumber:7},this)},void 0,!1,{fileName:fe,lineNumber:111,columnNumber:5},this)}var Je="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/electron/app.tsx";function Wt(){const[e,t]=c.exports.useState(void 0),[r,o]=c.exports.useState(window.innerWidth),[i,n]=c.exports.useState(window.innerHeight),[s,a]=c.exports.useState(void 0),[x,u]=c.exports.useState(void 0),p=c.exports.useCallback(async(f,m)=>{!s||!f||window.screenshots.save(await f.arrayBuffer(),{bounds:m,display:s})},[s]),l=c.exports.useCallback(()=>{window.screenshots.cancel()},[]),h=c.exports.useCallback(async(f,m)=>{console.log(f),!(!s||!f)&&window.screenshots.ok(await f.arrayBuffer(),{bounds:m,display:s})},[s]);return c.exports.useEffect(()=>{const f=y=>{u(y)},m=async y=>{a(y);const N=await window.screenshots.capture(y);t(N),window.screenshots.captured()};return window.screenshots.on("setLang",f),window.screenshots.on("capture",m),window.screenshots.ready(),()=>{window.screenshots.off("capture",m),window.screenshots.off("setLang",f)}},[]),c.exports.useEffect(()=>{const f=()=>{o(window.innerWidth),n(window.innerHeight)},m=({code:y})=>{y==="Escape"&&l()};return window.addEventListener("resize",f),window.addEventListener("keyup",m),()=>{window.removeEventListener("resize",f),window.removeEventListener("keyup",m)}},[l]),b.exports.jsxDEV("div",{className:"body",children:b.exports.jsxDEV(It,{url:e,width:r,height:i,lang:x,onSave:p,onCancel:l,onOk:h},void 0,!1,{fileName:Je,lineNumber:91,columnNumber:7},this)},void 0,!1,{fileName:Je,lineNumber:90,columnNumber:5},this)}var qe="/Users/nashaofu/Documents/GitHub/screenshots/packages/react-screenshots/src/electron/index.tsx";tt.render(b.exports.jsxDEV(c.exports.StrictMode,{children:b.exports.jsxDEV(Wt,{},void 0,!1,{fileName:qe,lineNumber:7,columnNumber:5},globalThis)},void 0,!1,{fileName:qe,lineNumber:6,columnNumber:3},globalThis),document.getElementById("app"));
